{"ast":null,"code":"var _jsxFileName = \"/Users/yubin/Documents/Youtube-master/go-chat-tutorial/frontend/webchat/src/app/pages/Chat/index.js\";\nimport React from 'react';\nimport { InputText } from '../../components/InputText';\nimport { Messages } from '../../components/Messages';\nimport { Status } from '../../components/Status';\nimport './styles.css';\nconst baseURL = 'ws://localhost:8080/chat';\nexport class Chat extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ws: undefined,\n      username: '',\n      message: '',\n      messages: []\n    };\n  }\n  render() {\n    const {\n      ws,\n      messages\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 17\n      }\n    }, \"WebChat\"), /*#__PURE__*/React.createElement(Status, {\n      status: ws ? 'connected' : 'disconnected',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 17\n      }\n    }), ws && /*#__PURE__*/React.createElement(Messages, {\n      messages: messages,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 27\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chat-inputs\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(InputText, {\n      placeholder: ws ? 'Write message' : 'Enter with your username',\n      onChange: value => ws ? this.setMessage(value) : this.setUsername(value),\n      defaultValue: ws ? this.state.message : this.state.username,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => ws ? this.sendMessage() : this.enterChat(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 21\n      }\n    }, ws ? 'Send' : 'Enter')));\n  }\n  enterChat() {\n    const {\n      username\n    } = this.state;\n    let ws = new WebSocket(baseURL + `?username=${username}`);\n    ws.onopen = evt => {\n      console.log('Websocket opened!', {\n        evt\n      });\n    };\n    ws.onclose = evt => {\n      console.log('Websocket closed!', {\n        evt\n      });\n      this.setState({\n        ws: undefined\n      });\n    };\n    ws.onmessage = msg => {\n      console.log('Websocket message:', {\n        msg\n      });\n      this.setMessages(msg.data);\n    };\n    ws.onerror = error => {\n      console.log('Websocket error:', {\n        error\n      });\n    };\n    this.setState({\n      ws,\n      username: ''\n    });\n  }\n  sendMessage() {\n    const {\n      ws,\n      message\n    } = this.state;\n    ws.send(message);\n    this.setMessage('');\n  }\n  setUsername(value) {\n    this.setState({\n      username: value\n    });\n  }\n  setMessage(value) {\n    this.setState({\n      message: value\n    });\n  }\n  setMessages(value) {\n    let messages = this.state.messages.concat([JSON.parse(value)]);\n    this.setState({\n      messages\n    });\n  }\n}","map":{"version":3,"names":["React","InputText","Messages","Status","baseURL","Chat","Component","constructor","props","state","ws","undefined","username","message","messages","render","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","status","placeholder","onChange","value","setMessage","setUsername","defaultValue","type","onClick","sendMessage","enterChat","WebSocket","onopen","evt","console","log","onclose","setState","onmessage","msg","setMessages","data","onerror","error","send","concat","JSON","parse"],"sources":["/Users/yubin/Documents/Youtube-master/go-chat-tutorial/frontend/webchat/src/app/pages/Chat/index.js"],"sourcesContent":["import React from 'react';\nimport { InputText } from '../../components/InputText';\nimport { Messages } from '../../components/Messages'\nimport { Status } from '../../components/Status';\nimport './styles.css';\n\nconst baseURL = 'ws://localhost:8080/chat';\n\nexport class Chat extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            ws: undefined,\n            username: '',\n            message: '',\n            messages: [],\n        }\n    }\n\n    render() {\n        const { ws, messages } = this.state;\n\n        return (\n            <div className=\"chat\">\n                <h1>WebChat</h1>\n                <Status status={ws ? 'connected' : 'disconnected'} />\n                {\n                    ws && <Messages messages={messages} />\n                }\n                <div className=\"chat-inputs\">\n                    <InputText \n                        placeholder={ws ? 'Write message' : 'Enter with your username'}\n                        onChange={value => ws ? this.setMessage(value) : this.setUsername(value)}\n                        defaultValue={ws ? this.state.message : this.state.username}\n                    />\n                    <button type=\"button\" onClick={() => ws ? this.sendMessage() : this.enterChat()}>\n                        {ws ? 'Send' : 'Enter'}\n                    </button>    \n                </div>\n            </div>\n        )\n    }\n\n    enterChat() {\n        const { username } = this.state;\n\n        let ws = new WebSocket(baseURL + `?username=${username}`);\n\n        ws.onopen = (evt) => {\n            console.log('Websocket opened!', {evt});\n        }\n\n        ws.onclose = (evt) => {\n            console.log('Websocket closed!', {evt});\n            this.setState({ws: undefined});\n        }\n\n        ws.onmessage = (msg) => {\n            console.log('Websocket message:', {msg});\n            this.setMessages(msg.data);\n        }\n\n        ws.onerror = (error) => {\n            console.log('Websocket error:', {error});\n        }\n\n        this.setState({ws, username: ''});\n    }\n\n    sendMessage() {\n        const { ws, message } = this.state;\n\n        ws.send(message);\n        this.setMessage('');\n    }\n\n    setUsername(value) {\n        this.setState({username: value});\n    }\n\n    setMessage(value) {\n        this.setState({message: value});\n    }\n\n    setMessages(value) {\n        let messages = this.state.messages.concat([JSON.parse(value)]);\n        this.setState({messages});\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}